<!--
The fuselage effect is a modified version of model-combined-deffered.
Modifications author: Nikolai V. Chr.
-->
<PropertyList>
	<name>Aircraft/f16/Models/Effects/fuselage/model-combined-fuselage</name>
	<inherits-from>Effects/model-combined-deferred</inherits-from>
	<parameters>
		<!-- Wingflex -->
		<wingflex type="int">0</wingflex>
		<body-width type="float">0.7</body-width>
		<wingflex-alpha>0.0</wingflex-alpha>
		<wingflex-trailing-alpha>0.0</wingflex-trailing-alpha>
		<wingsweep-factor>0.0</wingsweep-factor>
		<wingflex-z>0.0</wingflex-z>
		<wing-span>15.0</wing-span>
		<!-- Sub: rotation -->
		<rotation-rad type="float">0.0</rotation-rad>
		<rotation-x1 type="float">0.0</rotation-x1>
		<rotation-y1 type="float">0.0</rotation-y1>
		<rotation-z1 type="float">0.0</rotation-z1>
		<rotation-x2 type="float">0.0</rotation-x2>
		<rotation-y2 type="float">0.0</rotation-y2>
		<rotation-z2 type="float">0.0</rotation-z2>
		<!-- END Wingflex -->
		<metallic type="float">0.80</metallic><!-- 0-1 -->
		<ambient-factor type="float">0.0</ambient-factor><!-- 0-1 -->
		<normalmap-dds-compression-bc3n>0</normalmap-dds-compression-bc3n>
		<reflection-enabled type="int">1</reflection-enabled>
        <reflect-map-enabled type="int">0</reflect-map-enabled>
        <reflection-correction type="float">-0.30</reflection-correction>
        <reflection-fresnel type="float">0.0</reflection-fresnel>
        <reflection-rainbow type="float">0.0</reflection-rainbow>
        <reflection-noise type="float">0.0</reflection-noise>
        <reflection-dynamic type="int">1</reflection-dynamic>
        <rain-enabled type="int">0</rain-enabled>
        <snow-enabled type="int">0</snow-enabled>
		<texture n="6">
            <image>Aircraft/f16/Models/Effects/fuselage/ao.png</image>
            <filter>linear</filter>
            <wrap-s>clamp</wrap-s>
            <wrap-t>clamp</wrap-t>
            <internal-format>normalized</internal-format>
		</texture>
		<lightmap-enabled type="int">0</lightmap-enabled>
		<lightmap-factor n="0"><use>sim/multiplay/generic/short[7]</use></lightmap-factor>
		<lightmap-color type="vec3d" n="0"> 1.0 0.0 0.0 </lightmap-color>
		<lightmap-factor n="1"><use>sim/multiplay/generic/short[7]</use></lightmap-factor>
		<lightmap-color type="vec3d" n="1"> 0.0 0.8 0.0 </lightmap-color>
		<lightmap-factor n="2"><use>sim/multiplay/generic/short[7]</use></lightmap-factor>
		<lightmap-color type="vec3d" n="2"> 0.0 0.0 0.30 </lightmap-color>
		<lightmap-factor n="3">0.0</lightmap-factor>
		<lightmap-color type="vec3d" n="3"> 0.0 0.0 0.0 </lightmap-color>
		<texture n="3">
			<type>white</type>
		</texture>
		<texture n="5">
            <type>cubemap</type>
            <images>
                <positive-x>Aircraft/Generic/Effects/CubeMaps/fair-sky/fair-sky_px.png</positive-x>
                <negative-x>Aircraft/Generic/Effects/CubeMaps/fair-sky/fair-sky_nx.png</negative-x>
                <positive-y>Aircraft/Generic/Effects/CubeMaps/fair-sky/fair-sky_py.png</positive-y>
                <negative-y>Aircraft/Generic/Effects/CubeMaps/fair-sky/fair-sky_ny.png</negative-y>
                <positive-z>Aircraft/Generic/Effects/CubeMaps/fair-sky/fair-sky_pz.png</positive-z>
                <negative-z>Aircraft/Generic/Effects/CubeMaps/fair-sky/fair-sky_nz.png</negative-z>
            </images>
            <filter>linear</filter>
          </texture>
	</parameters>
	<!--
		Textures:

		0 - livery (rgba)
		1 - autogen. 3D noise
		2 - normal (rgb) & shininess (a) [Note: shininess is ignored if dds bc3n compression is used]
		3 - light (rgba)
		4 - reflect map (a) & dirt (rgb)
		5 - reflect cube map (rgb)
		6 - fresnel (rgb) & rainbow (rgb) & ambient occlusion (a)
		7 - grain (rgba)

		TODO:
			should fog, haze be done in linear or gamma corrected space?
	-->
	<technique n="1"><!-- ALS -->
	   <predicate>
		   <and>
			   <property>/sim/rendering/shaders/skydome</property>
			   <property>/sim/rendering/shaders/quality-level</property>
			   <property>/sim/rendering/shaders/model</property>
			   <or>
				   <less-equal>
					   <value type="float">2.0</value>
					   <glversion/>
				   </less-equal>
				   <and>
					   <extension-supported>GL_ARB_shader_objects</extension-supported>
					   <extension-supported>GL_ARB_shading_language_100</extension-supported>
					   <extension-supported>GL_ARB_vertex_shader</extension-supported>
					   <extension-supported>GL_ARB_fragment_shader</extension-supported>
					   <!--extension-supported>GL_ARB_gpu_shader5</extension-supported-->
				   </and>
			   </or>
		   </and>
	   </predicate>
	   <pass>
		   <lighting>true</lighting>
		   <material>
			   <active>
				   <use>material/active</use>
			   </active>
			   <ambient>
				   <use>material/ambient</use>
			   </ambient>
			   <diffuse>
				   <use>material/diffuse</use>
			   </diffuse>
			   <specular>
				   <use>material/specular</use>
			   </specular>
			   <emissive>
				   <use>material/emissive</use>
			   </emissive>
			   <shininess>
				   <use>material/shininess</use>
			   </shininess>
			   <color-mode>
				   <use>material/color-mode</use>
			   </color-mode>
		   </material>
		   <blend>
			   <active>
				   <use>blend/active</use>
			   </active>
			   <source>
				   <use>blend/source</use>
			   </source>
			   <destination>
				   <use>blend/destination</use>
			   </destination>
		   </blend>
		   <shade-model>
			   <use>shade-model</use>
		   </shade-model>
		   <cull-face>
			   <use>cull-face</use>
		   </cull-face>
		   <rendering-hint>
			   <use>rendering-hint</use>
		   </rendering-hint>
		   <blend>
			   <use>transparent</use>
		   </blend>
		   <alpha-test>
			   <use>transparent</use>
		   </alpha-test>
		   <render-bin>
			   <bin-number>
				   <use>render-bin/bin-number</use>
			   </bin-number>
			   <bin-name>
				   <use>render-bin/bin-name</use>
			   </bin-name>
		   </render-bin>
		   <!-- Diffuse texture unit-->
		   <texture-unit>
			   <unit>0</unit>
			   <image>
				   <use>texture[0]/image</use>
			   </image>
               <type>
                   <use>texture[0]/type</use>
               </type>
			   <filter>
				   <use>texture[0]/filter</use>
			   </filter>
			   <wrap-s>
				   <use>texture[0]/wrap-s</use>
			   </wrap-s>
			   <wrap-t>
				   <use>texture[0]/wrap-t</use>
			   </wrap-t>
			   <internal-format>
				   <use>texture[0]/internal-format</use>
			   </internal-format>
		   </texture-unit>
		   <!-- Reflection Noise texture unit-->
		   <texture-unit>
			   <unit>1</unit>
			   <type>noise</type>
		   </texture-unit>
		   <!-- NormalMap texture unit-->
		   <texture-unit>
			   <unit>2</unit>
			   <image>
				   <use>texture[2]/image</use>
			   </image>
               <type>
                   <use>texture[2]/type</use>
               </type>
			   <filter>
				   <use>texture[2]/filter</use>
			   </filter>
			   <wrap-s>
				   <use>texture[2]/wrap-s</use>
			   </wrap-s>
			   <wrap-t>
				   <use>texture[2]/wrap-t</use>
			   </wrap-t>
			   <internal-format>
				   <use>texture[2]/internal-format</use>
			   </internal-format>
		   </texture-unit>
		   <!-- LightMap texture unit-->
		   <texture-unit>
			   <unit>3</unit>
			   <image>
				   <use>texture[3]/image</use>
			   </image>
               <type>
                   <use>texture[3]/type</use>
               </type>
			   <filter>
				   <use>texture[3]/filter</use>
			   </filter>
			   <wrap-s>
				   <use>texture[3]/wrap-s</use>
			   </wrap-s>
			   <wrap-t>
				   <use>texture[3]/wrap-t</use>
			   </wrap-t>
			   <internal-format>
				   <use>texture[3]/internal-format</use>
			   </internal-format>
		   </texture-unit>
		   <!-- ReflectMap texture unit-->
		   <texture-unit>
			   <unit>4</unit>
			   <image>
				   <use>texture[4]/image</use>
			   </image>
               <type>
                   <use>texture[4]/type</use>
               </type>
			   <filter>
				   <use>texture[4]/filter</use>
			   </filter>
			   <wrap-s>
				   <use>texture[4]/wrap-s</use>
			   </wrap-s>
			   <wrap-t>
				   <use>texture[4]/wrap-t</use>
			   </wrap-t>
			   <internal-format>
				   <use>texture[4]/internal-format</use>
			   </internal-format>
		   </texture-unit>
		   <!-- Reflection CubeMap texture unit-->
		   <texture-unit>
			   <unit>5</unit>
			   <type>
				   <use>texture[5]/type</use>
			   </type>
			   <!-- use this form for a cube cross -->
			   <!--<image>
			   <use>texture[5]/image</use>
		   </image>-->
			   <!-- END CubeCross -->
			   <!-- use this form for a 6 image cube map -->
			   <images>
				   <use>texture[5]/images</use>
			   </images>
			   <!-- END 6 image cube map -->
			   </texture-unit>
			   <!-- Reflection gradients texture unit-->
			   <texture-unit>
				   <unit>6</unit>
				   <image>
					   <use>texture[6]/image</use>
				   </image>
                   <type>
                       <use>texture[6]/type</use>
                   </type>
				   <filter>
					   <use>texture[6]/filter</use>
				   </filter>
				   <wrap-s>
					   <use>texture[6]/wrap-s</use>
				   </wrap-s>
				   <wrap-t>
					   <use>texture[6]/wrap-t</use>
				   </wrap-t>
				   <internal-format>
					   <use>texture[6]/internal-format</use>
				   </internal-format>
			   </texture-unit>
			   <!-- Grain texture -->
		  	   <texture-unit>
				   <unit>7</unit>
				   <image>
			 	   	<use>texture[7]/image</use>
				   </image>
                   <type>
                    <use>texture[7]/type</use>
                   </type>
				   <filter>
			 		<use>texture[7]/filter</use>
				   </filter>
				   <wrap-s>
			   		<use>texture[7]/wrap-s</use>
				   </wrap-s>
				   <wrap-t>
			 		<use>texture[7]/wrap-t</use>
				   </wrap-t>
				   <internal-format>
			  		<use>texture[7]/internal-format</use>
				   </internal-format>
		  	   </texture-unit>
			   
			   <vertex-program-two-side>
				   <use>vertex-program-two-side</use>
			   </vertex-program-two-side>
			   
			   <program>
				<vertex-shader n="0">Aircraft/f16/Models/Effects/fuselage/model-combined-fuselage-ALS.vert</vertex-shader>
			 	<fragment-shader n="0">Aircraft/f16/Models/Effects/fuselage/model-combined-fuselage-ALS.frag</fragment-shader>
				<fragment-shader n="1">Shaders/cloud-shadowfunc.frag</fragment-shader>
				<fragment-shader n="2">Shaders/hazes.frag</fragment-shader>
				<fragment-shader n="3">Shaders/secondary_lights.frag</fragment-shader>
				<fragment-shader n="4">Shaders/noise.frag</fragment-shader>
				<fragment-shader n="5">Shaders/filters-ALS.frag</fragment-shader>
			   </program>
			   
			   <uniform>
				   <name>BaseTex</name>
				   <type>sampler-2d</type>
				   <value type="int">0</value>
			   </uniform>
			   
			   <uniform>
				   <name>ReflNoiseTex</name>
				   <type>sampler-3d</type>
				   <value type="int">1</value>
			   </uniform>
			   
			   <uniform>
				   <name>NormalTex</name>
				   <type>sampler-2d</type>
				   <value type="int">2</value>
			   </uniform>
			   
			   <uniform>
				   <name>LightMapTex</name>
				   <type>sampler-2d</type>
				   <value type="int">3</value>
			   </uniform>
			   
			   <uniform>
				   <name>ReflMapTex</name>
				   <type>sampler-2d</type>
				   <value type="int">4</value>
			   </uniform>
			   
			   <uniform>
				   <name>Environment</name>
				   <type>sampler-cube</type>
				   <value type="int">5</value>
			   </uniform>
			   
			   <uniform>
				   <name>ReflGradientsTex</name>
				   <type>sampler-2d</type>
				   <value type="int">6</value>
			   </uniform>
			   
			   <uniform>
				   <name>GrainTex</name>
				   <type>sampler-2d</type>
				   <value type="int">7</value>
		 	   </uniform>
			   
			   <!-- 			NORMAL MAP -->
			   <!-- normalmap is used-->
			   <uniform>
				   <name>nmap_enabled</name>
				   <type>int</type>
				   <value>
					   <use>normalmap-enabled</use>
				   </value>
			   </uniform>
			   
			   <!-- normalmap is .dds-->
			   <uniform>
				   <name>nmap_dds</name>
				   <type>int</type>
				   <value>
					   <use>normalmap-dds</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>bc3n</name>
				   <type>int</type>
				   <value>
					   <use>normalmap-dds-compression-bc3n</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				  <name>lonDeg</name>
				  <type>float</type>
				  <value>
					  <use>pos-lon</use>
				  </value>
			  </uniform>

			  <uniform>
				  <name>latDeg</name>
				  <type>float</type>
				  <value>
					  <use>pos-lat</use>
				  </value>
			  </uniform>
		  
			   <!--<uniform>
				   <name>nmap_tile</name>
				   <type>float</type>
				   <value>
					   <use>normalmap-tiling</use>
				   </value>
			   </uniform>-->
			   
			   <!-- 			LIGHTMAP -->
			   <!-- lightmap is used -->
			   <uniform>
				   <name>lightmap_enabled</name>
				   <type>int</type>
				   <value>
					   <use>lightmap-enabled</use>
				   </value>
			   </uniform>
			   <!-- lightmap is multichannel -->
			   <uniform>
				   <name>lightmap_multi</name>
				   <type>int</type>
				   <value>
					   <use>lightmap-multi</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>lightmap_r_factor</name>
				   <type>float</type>
				   <value>
					   <use>lightmap-factor[0]</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>lightmap_r_color</name>
				   <type>float-vec3</type>
				   <value>
					   <use>lightmap-color[0]</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>lightmap_g_factor</name>
				   <type>float</type>
				   <value>
					   <use>lightmap-factor[1]</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>lightmap_g_color</name>
				   <type>float-vec3</type>
				   <value>
					   <use>lightmap-color[1]</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>lightmap_b_factor</name>
				   <type>float</type>
				   <value>
					   <use>lightmap-factor[2]</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>lightmap_b_color</name>
				   <type>float-vec3</type>
				   <value>
					   <use>lightmap-color[2]</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>lightmap_a_factor</name>
				   <type>float</type>
				   <value>
					   <use>lightmap-factor[3]</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>lightmap_a_color</name>
				   <type>float-vec3</type>
				   <value>
					   <use>lightmap-color[3]</use>
				   </value>
			   </uniform>

		  	<!--<uniform>
				<name>darkmap_factor</name>
				<type>float</type>
				<value>
			 	 <use>darkmap-factor</use>
				</value>
		  	</uniform>-->
			   
			   <!-- reflection is used -->
			   <uniform>
				   <name>refl_enabled</name>
				   <type>int</type>
				   <value>
					   <use>reflection-enabled</use>
				   </value>
			   </uniform>
			   <!-- reflection correction -->
			   <uniform>
				   <name>refl_correction</name>
				   <type>float</type>
				   <value>
					   <use>reflection-correction</use>
				   </value>
			   </uniform>

			   <!-- Fresnel reflectivity -->
			   <uniform>
				   <name>refl_fresnel_factor</name>
				   <type>float</type>
				   <value>
					   <use>reflection-fresnel-factor</use>
				   </value>
			   </uniform>
			   
			   <!-- use a reflection map-->
			   <uniform>
				   <name>refl_map</name>
				   <type>int</type>
				   <value>
					   <use>reflect-map-enabled</use>
				   </value>
			   </uniform>

			   <!-- how are colors merged in a reflection-->
			   <!--<uniform>
				   <name>refl_type</name>
				   <type>int</type>
				   <value>
					   <use>reflection-type</use>
				   </value>
			   </uniform>-->


			   <!-- reflection is dynamic -->
			   <uniform>
				   <name>refl_dynamic</name>
				   <type>int</type>
				   <value>
					   <use>reflection-dynamic</use>
				   </value>
			   </uniform>
			   
			   <!-- set the amount of fringing colour 0.0 - 1.0 -->
			   <uniform>
				   <name>refl_rainbow</name>
				   <type>float</type>
				   <value>
					   <use>reflection-rainbow</use>
				   </value>
			   </uniform>
			   
			   <!-- set the amount of fresnel effect colour 0.0 - 1.0 -->
			   <uniform>
				   <name>refl_fresnel</name>
				   <type>float</type>
				   <value>
					   <use>reflection-fresnel</use>
				   </value>
			   </uniform>
			   
			   <!-- set the amount of noisiness 0.0 - 1.0 -->
			   <uniform>
				   <name>refl_noise</name>
				   <type>float</type>
				   <value>
					   <use>reflection-noise</use>
				   </value>
			   </uniform>
			   
			   <!-- dirt -->
			   <uniform>
				   <name>dirt_enabled</name>
				   <type>int</type>
				   <value>
					   <use>dirt-enabled</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>dirt_multi</name>
				   <type>int</type>
				   <value>
					   <use>dirt-multi</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>dirt_r_color</name>
				   <type>float-vec3</type>
				   <value>
					   <use>dirt-color[0]</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>dirt_r_factor</name>
				   <type>float</type>
				   <value>
					   <use>dirt-factor[0]</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>dirt_g_color</name>
				   <type>float-vec3</type>
				   <value>
					   <use>dirt-color[1]</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>dirt_g_factor</name>
				   <type>float</type>
				   <value>
					   <use>dirt-factor[1]</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>dirt_b_color</name>
				   <type>float-vec3</type>
				   <value>
					   <use>dirt-color[2]</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>dirt_b_factor</name>
				   <type>float</type>
				   <value>
					   <use>dirt-factor[2]</use>
				   </value>
			   </uniform>

			   <uniform>
				   <name>dirt_modulates_reflection</name>
				   <type>int</type>
				   <value>
					   <use>dirt-modulates-reflection</use>
				   </value>
			   </uniform>

			   <uniform>
				   <name>dirt_reflection_factor</name>
				   <type>float</type>
				   <value>
					   <use>dirt-reflection-factor</use>
				   </value>
			   </uniform>
			   

			   <!-- use a grain texture map-->
		  	   <uniform>
				   <name>grain_texture_enabled</name>
				   <type>int</type>
				   <value>
			  	   	<use>grain-texture-enabled</use>
				   </value>
		  	   </uniform>
		  
		  	   <uniform>
				   <name>grain_magnification</name>
				   <type>float</type>
				   <value>
			  		<use>grain-magnification</use>
				   </value>
		  	   </uniform>

			   <!-- simulate wetness, rain and snow -->
		  	    <uniform>
				   <name>rain_enabled</name>
				   <type>int</type>
				   <value>
			  	   	<use>rain-enabled</use>
				   </value>
		  	    </uniform>
			   
			    <uniform>
				   <name>snow_enabled</name>
				   <type>int</type>
				   <value>
			  	   	<use>snow-enabled</use>
				   </value>
		  	    </uniform>
			   
			   	<uniform>
        			   <name>snowlevel</name>
        			   <type>float</type>
        			   <value><use>snow_level</use></value>
      			   </uniform>

			   <uniform>
				   <name>snow_thickness_factor</name>
				   <type>float</type>
				   <value><use>snow_thickness_factor</use></value>
			   </uniform>

			   <!-- set the amount of ambient light correction 0.0 - 1.0  -->
			   <!--<uniform>
				   <name>amb_correction</name>
				   <type>float</type>
				   <value>
					   <use>ambient-correction</use>
				   </value>
			   </uniform>-->
			   
			   <uniform>
				   <name>hdg</name>
				   <type>float</type>
				   <value>
					   <use>model-hdg</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>pitch</name>
				   <type>float</type>
				   <value>
					   <use>model-pitch</use>
				   </value>
			   </uniform>
			   
			   <uniform>
				   <name>roll</name>
				   <type>float</type>
				   <value>
					   <use>model-roll</use>
				   </value>
			   </uniform>
			   
			   <!-- 	    BEGIN fog include -->
			   <uniform>
				   <name>visibility</name>
				   <type>float</type>
				   <value>
					   <use>visibility</use>
				   </value>
			   </uniform>
			   <uniform>
				   <name>avisibility</name>
				   <type>float</type>
				   <value>
					   <use>avisibility</use>
				   </value>
			   </uniform>
			   <uniform>
				   <name>hazeLayerAltitude</name>
				   <type>float</type>
				   <value>
					   <use>lthickness</use>
				   </value>
			   </uniform>
			   <uniform>
				   <name>scattering</name>
				   <type>float</type>
				   <value>
					   <use>scattering</use>
				   </value>
			   </uniform>
			   <uniform>
				   <name>terminator</name>
				   <type>float</type>
				   <value>
					   <use>terminator</use>
				   </value>
			   </uniform>
			   <uniform>
				   <name>ground_scattering</name>
				   <type>float</type>
				   <value>
					   <use>ground_scattering</use>
				   </value>
			   </uniform>
			   <uniform>
				   <name>terminator</name>
				   <type>float</type>
				   <value>
					   <use>terminator</use>
				   </value>
			   </uniform>
			   <uniform>
				   <name>terrain_alt</name>
				   <type>float</type>
				   <value>
					   <use>terrain_alt</use>
				   </value>
			   </uniform>
			   <uniform>
				   <name>overcast</name>
				   <type>float</type>
				   <value>
					   <use>overcast</use>
				   </value>
			   </uniform>
			   <uniform>
				   <name>eye_alt</name>
				   <type>float</type>
				   <value>
					   <use>eye_alt</use>
				   </value>
			   </uniform>
      			   <uniform>
        		 	   <name>cloud_self_shading</name>
        		           <type>float</type>
        			   <value><use>cloud_self_shading</use></value>
      			   </uniform>
      			   <uniform>
        			   <name>moonlight</name>
        			   <type>float</type>
        			   <value><use>moonlight</use></value>
      			   </uniform>
   			   <uniform>
        			   <name>air_pollution</name>
       				   <type>float</type>
       				   <value><use>air_pollution</use></value>
     			   </uniform>
   			   <uniform>
        			   <name>rain_norm</name>
       				   <type>float</type>
       				   <value><use>rnorm</use></value>
     			   </uniform>
   			   <uniform>
        			   <name>wetness</name>
       				   <type>float</type>
       				   <value><use>wetness</use></value>
     			   </uniform>
			   <uniform>
         			   <name>view_pitch_offset</name>
    				   <type>float</type>
      				   <value><use>view_pitch_offset</use></value>
     			   </uniform>
    			   <uniform>
    				   <name>view_heading_offset</name>
     				   <type>float</type>
     				   <value><use>view_heading_offset</use></value>
    			   </uniform>
    			   <uniform>
     				   <name>field_of_view</name>
    				   <type>float</type>
     				   <value><use>view_fov</use></value>
     			   </uniform>
   			   <uniform>
    				   <name>landing_light1_offset</name>
    				   <type>float</type>
      				   <value><use>landing_light1_offset</use></value>
     			   </uniform>
   			   <uniform>
     				   <name>landing_light2_offset</name>
    				   <type>float</type>
     				   <value><use>landing_light2_offset</use></value>
     			   </uniform>
                   	   <uniform>
                       		   <name>landing_light3_offset</name>
                       	           <type>float</type>
                       		   <value><use>landing_light3_offset</use></value>
                   	   </uniform>
 			<uniform>
        			<name>gamma</name>
        			<type>float</type>
       			 <value><use>gamma</use></value>
      			</uniform>
      			<uniform>
        			<name>brightness</name>
        			<type>float</type>
       			 <value><use>brightness</use></value>
      			</uniform>
      			<uniform>
        			<name>use_filtering</name>
        			<type>bool</type>
        			<value><use>use_filtering</use></value>
      			</uniform>
      			<uniform>
       				 <name>use_night_vision</name>
        			  <type>bool</type>
       			 	   <value><use>use_night_vision</use></value>
      			  </uniform>
      			  <uniform>
       			 	<name>use_IR_vision</name>
        			<type>bool</type>
       			 	<value><use>use_IR_vision</use></value>
      			   </uniform>
     			   <uniform>
        			<name>delta_T</name>
        			<type>float</type>
        			<value><use>delta_T</use></value>
      			   </uniform>
			   <uniform>
				<name>fact_grey</name>
				<type>float</type>
				<value><use>fact_grey</use></value>
			   </uniform>
			   <uniform>
				<name>fact_black</name>
				<type>float</type>
				<value><use>fact_black</use></value>
			   </uniform>

			  <!-- cloud shadows -->
 			   <uniform>
       				  <name>cloudpos1_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos1_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos1_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos1_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos2_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos2_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos2_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos2_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos3_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos3_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos3_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos3_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos4_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos4_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos4_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos4_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos5_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos5_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos5_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos5_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos6_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos6_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos6_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos6_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos7_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos7_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos7_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos7_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos8_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos8_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos8_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos8_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos9_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos9_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos9_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos9_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos10_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos10_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos10_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos10_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos11_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos11_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos11_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos11_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos12_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos12_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos12_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos12_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos13_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos13_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos13_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos13_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos14_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos14_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos14_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos14_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos15_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos15_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos15_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos15_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos16_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos16_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos16_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos16_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos17_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos17_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos17_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos17_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos18_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos18_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos18_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos18_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos19_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos19_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos19_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos19_y</use></value>
      			   </uniform>
			   <uniform>
       				  <name>cloudpos20_x</name>
        			  <type>float</type>
        		   <value><use>cloudpos20_x</use></value>
      			   </uniform>
	  		   <uniform>
       				  <name>cloudpos20_y</name>
        			  <type>float</type>
        			  <value><use>cloudpos20_y</use></value>
      			   </uniform>
	  		   <uniform>
        			  <name>cloud_shadow_flag</name>
        			  <type>int</type>
        			  <value><use>cloud_shadow_flag</use></value>
      			   </uniform>
			   <uniform>
				  <name>use_searchlight</name>
	 			  <type>int</type>
				  <value><use>use_searchlight</use></value>
     			   </uniform>
    			   <uniform>
				  <name>use_landing_light</name>
				  <type>int</type>
	   			  <value><use>use_landing_light</use></value>
      			   </uniform>
     			   <uniform>
				  <name>use_alt_landing_light</name>
				  <type>int</type>
				  <value><use>use_alt_landing_light</use></value>
     			   </uniform>
     			   <uniform>
       				  <name>display_xsize</name>
      				  <type>int</type>
      				  <value><use>display_xsize</use></value>
    			   </uniform>
     			   <uniform>
       				  <name>display_ysize</name>
      				  <type>int</type>
      				  <value><use>display_ysize</use></value>
    			   </uniform>  
			   <uniform>
				  <name>darkmap_enabled</name>
	 			  <type>int</type>
				  <value><use>darkmap-enabled</use></value>
     			   </uniform>

     		<uniform>
				<name>metallic</name>
				<type>float</type>
				<value>
			 	 <use>metallic</use>
				</value>
		  	</uniform>

		  	<uniform>
				<name>ambient_factor</name>
				<type>float</type>
				<value>
			 	 <use>ambient-factor</use>
				</value>
		  	</uniform>
		  	
		  	<uniform>
				   <name>wingflex</name>
				   <type>int</type>
				   <value><use>wingflex</use></value>
			   </uniform>
			   
		   	   <uniform>
				   <name>wingflex_z</name>
				   <type>float</type>
				   <value><use>wingflex-z</use></value>
			   </uniform>

		   	   <uniform>
				   <name>body_width</name>
				   <type>float</type>
				   <value><use>body-width</use></value>
			   </uniform>

		   	   <uniform>
				   <name>wing_span</name>
				   <type>float</type>
				   <value><use>wing-span</use></value>
			   </uniform>

		   	   <uniform>
				   <name>rotation_rad</name>
				   <type>float</type>
				   <value><use>rotation-rad</use></value>
			   </uniform>

		   	   <uniform>
				   <name>rotation_x1</name>
				   <type>float</type>
				   <value><use>rotation-x1</use></value>
			   </uniform>

		   	   <uniform>
				   <name>rotation_y1</name>
				   <type>float</type>
				   <value><use>rotation-y1</use></value>
			   </uniform>

		   	   <uniform>
				   <name>rotation_z1</name>
				   <type>float</type>
				   <value><use>rotation-z1</use></value>
			   </uniform>
			   
		   	   <uniform>
				   <name>rotation_x2</name>
				   <type>float</type>
				   <value><use>rotation-x2</use></value>
			   </uniform>

		   	   <uniform>
				   <name>rotation_y2</name>
				   <type>float</type>
				   <value><use>rotation-y2</use></value>
			   </uniform>

		   	   <uniform>
				   <name>rotation_z2</name>
				   <type>float</type>
				   <value><use>rotation-z2</use></value>
			   </uniform>

		  <!-- 			END fog include -->
		  <!--<uniform>
			<name>rembrandt_enabled</name>
			<type>int</type>
			<value>
			  <use>rembrandt</use>
			</value>
		  </uniform>-->
		  </pass>
	</technique>
	
	<!-- 	Rembrandt rendering -->
   <technique n="2">
	<predicate>
	  <and>
		<property>/sim/rendering/rembrandt/enabled</property>
		<or>
		  <less-equal>
			<value type="float">2.0</value>
			<glversion/>
		  </less-equal>
		  <and>
			<extension-supported>GL_ARB_shader_objects</extension-supported>
			<extension-supported>GL_ARB_shading_language_100</extension-supported>
			<extension-supported>GL_ARB_vertex_shader</extension-supported>
			<extension-supported>GL_ARB_fragment_shader</extension-supported>
		  </and>
		</or>
	  </and>
	</predicate>
		<pass>
			<lighting>true</lighting>
			<material>
				<active>
					<use>material/active</use>
				</active>
				<ambient>
					<use>material/ambient</use>
				</ambient>
				<diffuse>
					<use>material/diffuse</use>
				</diffuse>
				<specular>
					<use>material/specular</use>
				</specular>
				<emissive>
					<use>material/emissive</use>
				</emissive>
				<shininess>
					<use>material/shininess</use>
				</shininess>
				<color-mode>
					<use>material/color-mode</use>
				</color-mode>
			</material>
			<blend>
				<active>
					<use>blend/active</use>
				</active>
				<source>
					<use>blend/source</use>
				</source>
				<destination>
					<use>blend/destination</use>
				</destination>
			</blend>
			<shade-model>
				<use>shade-model</use>
			</shade-model>
			<cull-face>
				<use>cull-face</use>
			</cull-face>
			<rendering-hint>
				<use>rendering-hint</use>
			</rendering-hint>
			<blend>
				<use>transparent</use>
			</blend>
			<alpha-test>
				<use>transparent</use>
			</alpha-test>
			<render-bin>
				<bin-number>
					<use>render-bin/bin-number</use>
				</bin-number>
				<bin-name>
					<use>render-bin/bin-name</use>
				</bin-name>
			</render-bin>
			<!-- Diffuse texture unit-->
			<texture-unit>
				<unit>0</unit>
				<image>
					<use>texture[0]/image</use>
				</image>
                <type>
                    <use>texture[0]/type</use>
                </type>
				<filter>
					<use>texture[0]/filter</use>
				</filter>
				<wrap-s>
					<use>texture[0]/wrap-s</use>
				</wrap-s>
				<wrap-t>
					<use>texture[0]/wrap-t</use>
				</wrap-t>
				<internal-format>
					<use>texture[0]/internal-format</use>
				</internal-format>
			</texture-unit>
			<!-- Reflection Noise texture unit-->
			<texture-unit>
				<unit>1</unit>
				<type>noise</type>
			</texture-unit>
			<!-- NormalMap texture unit-->
			<texture-unit>
				<unit>2</unit>
				<image>
					<use>texture[2]/image</use>
				</image>
                <type>
                    <use>texture[2]/type</use>
                </type>
				<filter>
					<use>texture[2]/filter</use>
				</filter>
				<wrap-s>
					<use>texture[2]/wrap-s</use>
				</wrap-s>
				<wrap-t>
					<use>texture[2]/wrap-t</use>
				</wrap-t>
				<internal-format>
					<use>texture[2]/internal-format</use>
				</internal-format>
			</texture-unit>
			<!-- LightMap texture unit-->
			<texture-unit>
				<unit>3</unit>
				<image>
					<use>texture[3]/image</use>
				</image>
                <type>
                    <use>texture[3]/type</use>
                </type>
				<filter>
					<use>texture[3]/filter</use>
				</filter>
				<wrap-s>
					<use>texture[3]/wrap-s</use>
				</wrap-s>
				<wrap-t>
					<use>texture[3]/wrap-t</use>
				</wrap-t>
				<internal-format>
					<use>texture[3]/internal-format</use>
				</internal-format>
			</texture-unit>
			<!-- ReflectMap texture unit-->
			<texture-unit>
				<unit>4</unit>
				<image>
					<use>texture[4]/image</use>
				</image>
                <type>
                    <use>texture[4]/type</use>
                </type>
				<filter>
					<use>texture[4]/filter</use>
				</filter>
				<wrap-s>
					<use>texture[4]/wrap-s</use>
				</wrap-s>
				<wrap-t>
					<use>texture[4]/wrap-t</use>
				</wrap-t>
				<internal-format>
					<use>texture[4]/internal-format</use>
				</internal-format>
			</texture-unit>
			<!-- Reflection CubeMap texture unit-->
			<texture-unit>
				<unit>5</unit>
				<type>
					<use>texture[5]/type</use>
				</type>
				<!-- use this form for a cube cross -->
				<!--<image><use>texture[5]/image</use></image>-->
				<!-- END CubeCross -->
				<!-- use this form for a 6 image cube map -->
				<images>
					<use>texture[5]/images</use>
				</images>
				<!-- END 6 image cube map -->
			</texture-unit>
			<!-- Reflection fresnel texture unit-->
			<texture-unit>
				<unit>6</unit>
				<image>
					<use>texture[6]/image</use>
				</image>
                <type>
                    <use>texture[6]/type</use>
                </type>
				<filter>
					<use>texture[6]/filter</use>
				</filter>
				<wrap-s>
					<use>texture[6]/wrap-s</use>
				</wrap-s>
				<wrap-t>
					<use>texture[6]/wrap-t</use>
				</wrap-t>
				<internal-format>
					<use>texture[6]/internal-format</use>
				</internal-format>
			</texture-unit>
			<!-- Reflection rainbow texture unit-->
<!--			<texture-unit>
				<unit>7</unit>
				<image>
					<use>texture[7]/image</use>
				</image>
				<filter>
					<use>texture[7]/filter</use>
				</filter>
				<wrap-s>
					<use>texture[7]/wrap-s</use>
				</wrap-s>
				<wrap-t>
					<use>texture[7]/wrap-t</use>
				</wrap-t>
				<internal-format>
					<use>texture[7]/internal-format</use>
				</internal-format>
			</texture-unit>-->


			<vertex-program-two-side>
				<use>vertex-program-two-side</use>
			</vertex-program-two-side>

	  <program n="0">
		<vertex-shader n="0">Shaders/ubershader.vert</vertex-shader>
		<fragment-shader n="0">Shaders/ubershader-gbuffer.frag</fragment-shader>
		<fragment-shader n="1">Shaders/gbuffer-functions.frag</fragment-shader>
		<fragment-shader n="2">Shaders/gbuffer-encode.frag</fragment-shader>
	  </program>

			<uniform>
				<name>BaseTex</name>
				<type>sampler-2d</type>
				<value type="int">0</value>
			</uniform>

            <uniform>
				<name>ReflNoiseTex</name>
				<type>sampler-3d</type>
				<value type="int">1</value>
			</uniform>

			<uniform>
				<name>NormalTex</name>
				<type>sampler-2d</type>
				<value type="int">2</value>
			</uniform>

			<uniform>
				<name>LightMapTex</name>
				<type>sampler-2d</type>
				<value type="int">3</value>
			</uniform>

			<uniform>
				<name>ReflMapTex</name>
				<type>sampler-2d</type>
				<value type="int">4</value>
			</uniform>

			<uniform>
				<name>Environment</name>
				<type>sampler-cube</type>
				<value type="int">5</value>
			</uniform>

            <uniform>
                <name>ReflGradientsTex</name>
                <type>sampler-2d</type>
                <value type="int">6</value>
			</uniform>

			<!-- 			NORMAL MAP -->
			<!-- normalmap is used-->
			<uniform>
				<name>nmap_enabled</name>
				<type>int</type>
				<value>
					<use>normalmap-enabled</use>
				</value>
			</uniform>

			<!-- normalmap is .dds-->
			<uniform>
				<name>nmap_dds</name>
				<type>int</type>
				<value>
					<use>normalmap-dds</use>
				</value>
			</uniform>

			<uniform>
				<name>nmap_tile</name>
				<type>float</type>
				<value>
					<use>normalmap-tiling</use>
				</value>
			</uniform>

			<!-- 			LIGHTMAP -->
			<!-- lightmap is used -->
			<uniform>
				<name>lightmap_enabled</name>
				<type>int</type>
				<value>
					<use>lightmap-enabled</use>
				</value>
			</uniform>
			<!-- lightmap is multichannel -->
			<uniform>
				<name>lightmap_multi</name>
				<type>int</type>
				<value>
					<use>lightmap-multi</use>
				</value>
			</uniform>

			<uniform>
				<name>lightmap_r_factor</name>
				<type>float</type>
				<value>
					<use>lightmap-factor[0]</use>
				</value>
			</uniform>

			<uniform>
				<name>lightmap_r_color</name>
				<type>float-vec3</type>
				<value>
					<use>lightmap-color[0]</use>
				</value>
			</uniform>

			<uniform>
				<name>lightmap_g_factor</name>
				<type>float</type>
				<value>
					<use>lightmap-factor[1]</use>
				</value>
			</uniform>

			<uniform>
				<name>lightmap_g_color</name>
				<type>float-vec3</type>
				<value>
					<use>lightmap-color[1]</use>
				</value>
			</uniform>

			<uniform>
				<name>lightmap_b_factor</name>
				<type>float</type>
				<value>
					<use>lightmap-factor[2]</use>
				</value>
			</uniform>

			<uniform>
				<name>lightmap_b_color</name>
				<type>float-vec3</type>
				<value>
					<use>lightmap-color[2]</use>
				</value>
			</uniform>

			<uniform>
				<name>lightmap_a_factor</name>
				<type>float</type>
				<value>
					<use>lightmap-factor[3]</use>
				</value>
			</uniform>

			<uniform>
				<name>lightmap_a_color</name>
				<type>float-vec3</type>
				<value>
					<use>lightmap-color[3]</use>
				</value>
			</uniform>

			<!-- 			reflection is used -->
			<uniform>
				<name>refl_enabled</name>
				<type>int</type>
				<value>
					<use>reflection-enabled</use>
				</value>
			</uniform>
			<!-- reflection correction -->
			<uniform>
				<name>refl_correction</name>
				<type>float</type>
				<value>
					<use>reflection-correction</use>
				</value>
			</uniform>

			<!-- use a reflection map-->
			<uniform>
				<name>refl_map</name>
				<type>int</type>
				<value>
					<use>reflect-map-enabled</use>
				</value>
			</uniform>
			<!-- reflection is dynamic -->
			<uniform>
				<name>refl_dynamic</name>
				<type>int</type>
				<value>
					<use>reflection-dynamic</use>
				</value>
			</uniform>

			<!-- set the amount of fringing colour 0.0 - 1.0 -->
			<uniform>
				<name>refl_rainbow</name>
				<type>float</type>
				<value>
					<use>reflection-rainbow</use>
				</value>
			</uniform>

			<!-- set the amount of fresnel effect colour 0.0 - 1.0 -->
			<uniform>
				<name>refl_fresnel</name>
				<type>float</type>
				<value>
					<use>reflection-fresnel</use>
				</value>
			</uniform>

			<!-- set the amount of noisiness 0.0 - 1.0 -->
			<uniform>
				<name>refl_noise</name>
				<type>float</type>
				<value>
					<use>reflection-noise</use>
				</value>
			</uniform>

			<!-- dirt -->
			<uniform>
				<name>dirt_enabled</name>
				<type>int</type>
				<value>
					<use>dirt-enabled</use>
				</value>
			</uniform>

			<uniform>
				<name>dirt_multi</name>
				<type>int</type>
				<value>
					<use>dirt-multi</use>
				</value>
			</uniform>

			<uniform>
				<name>dirt_r_color</name>
				<type>float-vec3</type>
				<value>
					<use>dirt-color[0]</use>
				</value>
			</uniform>

			<uniform>
				<name>dirt_r_factor</name>
				<type>float</type>
				<value>
					<use>dirt-factor[0]</use>
				</value>
			</uniform>

			<uniform>
				<name>dirt_g_color</name>
				<type>float-vec3</type>
				<value>
					<use>dirt-color[1]</use>
				</value>
			</uniform>

			<uniform>
				<name>dirt_g_factor</name>
				<type>float</type>
				<value>
					<use>dirt-factor[1]</use>
				</value>
			</uniform>

			<uniform>
				<name>dirt_b_color</name>
				<type>float-vec3</type>
				<value>
					<use>dirt-color[2]</use>
				</value>
			</uniform>

			<uniform>
				<name>dirt_b_factor</name>
				<type>float</type>
				<value>
					<use>dirt-factor[2]</use>
				</value>
			</uniform>

			<!-- set the amount of ambient light correction 0.0 - 1.0  -->
			<uniform>
				<name>amb_correction</name>
				<type>float</type>
				<value>
					<use>ambient-correction</use>
				</value>
			</uniform>

			<uniform>
				<name>lonDeg</name>
				<type>float</type>
				<value>
					<use>pos-lon</use>
				</value>
			</uniform>

			<uniform>
				<name>latDeg</name>
				<type>float</type>
				<value>
					<use>pos-lat</use>
				</value>
			</uniform>

			<!-- 	    BEGIN fog include -->
			<!--<uniform>
				<name>visibility</name>
				<type>float</type>
				<value>
					<use>visibility</use>
				</value>
			</uniform>
			<uniform>
				<name>avisibility</name>
				<type>float</type>
				<value>
					<use>avisibility</use>
				</value>
			</uniform>
			<uniform>
				<name>hazeLayerAltitude</name>
				<type>float</type>
				<value>
					<use>lthickness</use>
				</value>
			</uniform>
			<uniform>
				<name>scattering</name>
				<type>float</type>
				<value>
					<use>scattering</use>
				</value>
			</uniform>
			<uniform>
				<name>terminator</name>
				<type>float</type>
				<value>
					<use>terminator</use>
				</value>
			</uniform>
			<uniform>
				<name>fogType</name>
				<type>int</type>
				<value>
					<use>fogtype</use>
				</value>
			</uniform>-->
			<!-- 			END fog include -->
			<uniform>
			  <name>rembrandt_enabled</name>
			  <type>int</type>
			  <value>
				<use>rembrandt</use>
			  </value>
			</uniform>
		</pass>
	</technique>



	<!-- Default rendering -->
	<technique n="3">
	  <predicate>
		<and>
		  <property>/sim/rendering/shaders/quality-level</property>
		  <property>/sim/rendering/shaders/model</property>
		  <or>
			<less-equal>
			  <value type="float">2.0</value>
			  <glversion/>
			</less-equal>
			<and>
			  <extension-supported>GL_ARB_shader_objects</extension-supported>
			  <extension-supported>GL_ARB_shading_language_100</extension-supported>
			  <extension-supported>GL_ARB_vertex_shader</extension-supported>
			  <extension-supported>GL_ARB_fragment_shader</extension-supported>
			</and>
		  </or>
		</and>
	  </predicate>
	  <pass n="0">
		<lighting>true</lighting>
		<material>
		  <active>
			<use>material/active</use>
		  </active>
		  <ambient>
			<use>material/ambient</use>
		  </ambient>
		  <diffuse>
			<use>material/diffuse</use>
		  </diffuse>
		  <specular>
			<use>material/specular</use>
		  </specular>
		  <emissive>
			<use>material/emissive</use>
		  </emissive>
		  <shininess>
			<use>material/shininess</use>
		  </shininess>
		  <color-mode>
			<use>material/color-mode</use>
		  </color-mode>
		</material>
		<blend>
		  <active>
			<use>blend/active</use>
		  </active>
		  <source>
			<use>blend/source</use>
		  </source>
		  <destination>
			<use>blend/destination</use>
		  </destination>
		</blend>
		<shade-model>
		  <use>shade-model</use>
		</shade-model>
		<cull-face>
		  <use>cull-face</use>
		</cull-face>
		<rendering-hint>
		  <use>rendering-hint</use>
		</rendering-hint>
		<blend>
		  <use>transparent</use>
		</blend>
		<alpha-test>
		  <use>transparent</use>
		</alpha-test>
		<render-bin>
		  <bin-number>
			<use>render-bin/bin-number</use>
		  </bin-number>
		  <bin-name>
			<use>render-bin/bin-name</use>
		  </bin-name>
		</render-bin>
		<!-- Diffuse texture unit-->
		<texture-unit>
		  <unit>0</unit>
		  <image>
			<use>texture[0]/image</use>
		  </image>
          <type>
            <use>texture[0]/type</use>
          </type>
		  <filter>
			<use>texture[0]/filter</use>
		  </filter>
		  <wrap-s>
			<use>texture[0]/wrap-s</use>
		  </wrap-s>
		  <wrap-t>
			<use>texture[0]/wrap-t</use>
		  </wrap-t>
		  <internal-format>
			<use>texture[0]/internal-format</use>
		  </internal-format>
		</texture-unit>
		<!-- Reflection Noise texture unit-->
		<texture-unit>
		  <unit>1</unit>
		  <type>noise</type>
		</texture-unit>
		<!-- NormalMap texture unit-->
		<texture-unit>
		  <unit>2</unit>
		  <image>
			<use>texture[2]/image</use>
		  </image>
          <type>
              <use>texture[2]/type</use>
          </type>
		  <filter>
			<use>texture[2]/filter</use>
		  </filter>
		  <wrap-s>
			<use>texture[2]/wrap-s</use>
		  </wrap-s>
		  <wrap-t>
			<use>texture[2]/wrap-t</use>
		  </wrap-t>
		  <internal-format>
			<use>texture[2]/internal-format</use>
		  </internal-format>
		</texture-unit>
		<!-- LightMap texture unit-->
		<texture-unit>
		  <unit>3</unit>
		  <image>
			<use>texture[3]/image</use>
		  </image>
          <type>
            <use>texture[3]/type</use>
          </type>
		  <filter>
			<use>texture[3]/filter</use>
		  </filter>
		  <wrap-s>
			<use>texture[3]/wrap-s</use>
		  </wrap-s>
		  <wrap-t>
			<use>texture[3]/wrap-t</use>
		  </wrap-t>
		  <internal-format>
			<use>texture[3]/internal-format</use>
		  </internal-format>
		</texture-unit>
		<!-- ReflectMap texture unit-->
		<texture-unit>
		  <unit>4</unit>
		  <image>
			<use>texture[4]/image</use>
		  </image>
          <type>
              <use>texture[4]/type</use>
          </type>
		  <filter>
			<use>texture[4]/filter</use>
		  </filter>
		  <wrap-s>
			<use>texture[4]/wrap-s</use>
		  </wrap-s>
		  <wrap-t>
			<use>texture[4]/wrap-t</use>
		  </wrap-t>
		  <internal-format>
			<use>texture[4]/internal-format</use>
		  </internal-format>
		</texture-unit>
		<!-- Reflection CubeMap texture unit-->
		<texture-unit>
		  <unit>5</unit>
		  <type>
			<use>texture[5]/type</use>
		  </type>
		  <!-- use this form for a cube cross -->
		  <!--<image>
		  <use>texture[5]/image</use>
		</image>-->
		  <!-- END CubeCross -->
		  <!-- use this form for a 6 image cube map -->
		  <images>
			<use>texture[5]/images</use>
		  </images>
		  <!-- END 6 image cube map -->
		  </texture-unit>
		  <!-- Reflection gradients texture unit-->
		  <texture-unit>
			<unit>6</unit>
			<image>
			  <use>texture[6]/image</use>
			</image>
            <type>
              <use>texture[6]/type</use>
            </type>
			<filter>
			  <use>texture[6]/filter</use>
			</filter>
			<wrap-s>
			  <use>texture[6]/wrap-s</use>
			</wrap-s>
			<wrap-t>
			  <use>texture[6]/wrap-t</use>
			</wrap-t>
			<internal-format>
			  <use>texture[6]/internal-format</use>
			</internal-format>
		  </texture-unit>

		  <vertex-program-two-side>
			<use>vertex-program-two-side</use>
		  </vertex-program-two-side>

		  <program n="0">
			  <vertex-shader n="0">Aircraft/f16/Models/Effects/fuselage/model-combined-fuselage.vert</vertex-shader>
			  <fragment-shader n="0">Shaders/include_fog.frag</fragment-shader>
			  <fragment-shader n="1">Aircraft/f16/Models/Effects/fuselage/model-combined-fuselage.frag</fragment-shader>
		  </program>

		  <uniform>
			<name>BaseTex</name>
			<type>sampler-2d</type>
			<value type="int">0</value>
		  </uniform>

		  <uniform>
			<name>ReflNoiseTex</name>
			<type>sampler-3d</type>
			<value type="int">1</value>
		  </uniform>

		  <uniform>
			<name>NormalTex</name>
			<type>sampler-2d</type>
			<value type="int">2</value>
		  </uniform>

		  <uniform>
			<name>LightMapTex</name>
			<type>sampler-2d</type>
			<value type="int">3</value>
		  </uniform>

		  <uniform>
			<name>ReflMapTex</name>
			<type>sampler-2d</type>
			<value type="int">4</value>
		  </uniform>

		  <uniform>
			<name>Environment</name>
			<type>sampler-cube</type>
			<value type="int">5</value>
		  </uniform>

		  <uniform>
			<name>ReflGradientsTex</name>
			<type>sampler-2d</type>
			<value type="int">6</value>
		  </uniform>

		  <!-- 			NORMAL MAP -->
		  <!-- normalmap is used-->
		  <uniform>
			<name>nmap_enabled</name>
			<type>int</type>
			<value>
			  <use>normalmap-enabled</use>
			</value>
		  </uniform>

		  <!-- normalmap is .dds-->
		  <uniform>
			<name>nmap_dds</name>
			<type>int</type>
			<value>
			  <use>normalmap-dds</use>
			</value>
		  </uniform>
		  
		  <uniform>
			   <name>bc3n</name>
			   <type>int</type>
			   <value>
				   <use>normalmap-dds-compression-bc3n</use>
			   </value>
		   </uniform>

		  <!--<uniform>
			<name>nmap_tile</name>
			<type>float</type>
			<value>
			  <use>normalmap-tiling</use>
			</value>
		  </uniform>-->

		  <!-- 			LIGHTMAP -->
		  <!-- lightmap is used -->
		  <uniform>
			<name>lightmap_enabled</name>
			<type>int</type>
			<value>
			  <use>lightmap-enabled</use>
			</value>
		  </uniform>
		  <!-- lightmap is multichannel -->
		  <uniform>
			<name>lightmap_multi</name>
			<type>int</type>
			<value>
			  <use>lightmap-multi</use>
			</value>
		  </uniform>

		  <uniform>
			<name>lightmap_r_factor</name>
			<type>float</type>
			<value>
			  <use>lightmap-factor[0]</use>
			</value>
		  </uniform>

		  <uniform>
			<name>lightmap_r_color</name>
			<type>float-vec3</type>
			<value>
			  <use>lightmap-color[0]</use>
			</value>
		  </uniform>

		  <uniform>
			<name>lightmap_g_factor</name>
			<type>float</type>
			<value>
			  <use>lightmap-factor[1]</use>
			</value>
		  </uniform>

		  <uniform>
			<name>lightmap_g_color</name>
			<type>float-vec3</type>
			<value>
			  <use>lightmap-color[1]</use>
			</value>
		  </uniform>

		  <uniform>
			<name>lightmap_b_factor</name>
			<type>float</type>
			<value>
			  <use>lightmap-factor[2]</use>
			</value>
		  </uniform>

		  <uniform>
			<name>lightmap_b_color</name>
			<type>float-vec3</type>
			<value>
			  <use>lightmap-color[2]</use>
			</value>
		  </uniform>

		  <uniform>
			<name>lightmap_a_factor</name>
			<type>float</type>
			<value>
			  <use>lightmap-factor[3]</use>
			</value>
		  </uniform>

		  <uniform>
			<name>lightmap_a_color</name>
			<type>float-vec3</type>
			<value>
			  <use>lightmap-color[3]</use>
			</value>
		  </uniform>

		  <!-- 			reflection is used -->
		  <uniform>
			<name>refl_enabled</name>
			<type>int</type>
			<value>
			  <use>reflection-enabled</use>
			</value>
		  </uniform>
		  <!-- reflection correction -->
		  <uniform>
			<name>refl_correction</name>
			<type>float</type>
			<value>
			  <use>reflection-correction</use>
			</value>
		  </uniform>

		  <!-- use a reflection map-->
		  <uniform>
			<name>refl_map</name>
			<type>int</type>
			<value>
			  <use>reflect-map-enabled</use>
			</value>
		  </uniform>
		  <!-- reflection is dynamic -->
		  <uniform>
			<name>refl_dynamic</name>
			<type>int</type>
			<value>
			  <use>reflection-dynamic</use>
			</value>
		  </uniform>

		  <!-- set the amount of fringing colour 0.0 - 1.0 -->
		  <uniform>
			<name>refl_rainbow</name>
			<type>float</type>
			<value>
			  <use>reflection-rainbow</use>
			</value>
		  </uniform>

		  <!-- set the amount of fresnel effect colour 0.0 - 1.0 -->
		  <uniform>
			<name>refl_fresnel</name>
			<type>float</type>
			<value>
			  <use>reflection-fresnel</use>
			</value>
		  </uniform>

		  <!-- set the amount of noisiness 0.0 - 1.0 -->
		  <uniform>
			<name>refl_noise</name>
			<type>float</type>
			<value>
			  <use>reflection-noise</use>
			</value>
		  </uniform>

		  <!-- dirt -->
		  <uniform>
			<name>dirt_enabled</name>
			<type>int</type>
			<value>
			  <use>dirt-enabled</use>
			</value>
		  </uniform>

		  <uniform>
			<name>dirt_multi</name>
			<type>int</type>
			<value>
			  <use>dirt-multi</use>
			</value>
		  </uniform>

		  <uniform>
			<name>dirt_r_color</name>
			<type>float-vec3</type>
			<value>
			  <use>dirt-color[0]</use>
			</value>
		  </uniform>

		  <uniform>
			<name>dirt_r_factor</name>
			<type>float</type>
			<value>
			  <use>dirt-factor[0]</use>
			</value>
		  </uniform>

		  <uniform>
			<name>dirt_g_color</name>
			<type>float-vec3</type>
			<value>
			  <use>dirt-color[1]</use>
			</value>
		  </uniform>

		  <uniform>
			<name>dirt_g_factor</name>
			<type>float</type>
			<value>
			  <use>dirt-factor[1]</use>
			</value>
		  </uniform>

		  <uniform>
			<name>dirt_b_color</name>
			<type>float-vec3</type>
			<value>
			  <use>dirt-color[2]</use>
			</value>
		  </uniform>

		  <uniform>
			<name>dirt_b_factor</name>
			<type>float</type>
			<value>
			  <use>dirt-factor[2]</use>
			</value>
		  </uniform>

		  <!-- set the amount of ambient light correction 0.0 - 1.0  -->
		  <!--<uniform>
			<name>amb_correction</name>
			<type>float</type>
			<value>
			  <use>ambient-correction</use>
			</value>
		  </uniform>-->


		  <uniform>
			  <name>lonDeg</name>
			  <type>float</type>
			  <value>
				  <use>pos-lon</use>
			  </value>
		  </uniform>

		  <uniform>
			  <name>latDeg</name>
			  <type>float</type>
			  <value>
				  <use>pos-lat</use>
			  </value>
		  </uniform>

		  <!-- 	    BEGIN fog include -->
		  <!--<uniform>
			<name>visibility</name>
			<type>float</type>
			<value>
			  <use>visibility</use>
			</value>
		  </uniform>
		  <uniform>
			<name>avisibility</name>
			<type>float</type>
			<value>
			  <use>avisibility</use>
			</value>
		  </uniform>
		  <uniform>
			<name>hazeLayerAltitude</name>
			<type>float</type>
			<value>
			  <use>lthickness</use>
			</value>
		  </uniform>
		  <uniform>
			<name>scattering</name>
			<type>float</type>
			<value>
			  <use>scattering</use>
			</value>
		  </uniform>
		  <uniform>
			<name>terminator</name>
			<type>float</type>
			<value>
			  <use>terminator</use>
			</value>
		  </uniform>-->
		  <!--<uniform>
			<name>fogType</name>
			<type>int</type>
			<value>
			  <use>fogtype</use>
			</value>
		  </uniform>-->
		  <uniform>
				<name>metallic</name>
				<type>float</type>
				<value>
			 	 <use>metallic</use>
				</value>
		  	</uniform>

		  	<uniform>
				<name>ambient_factor</name>
				<type>float</type>
				<value>
			 	 <use>ambient-factor</use>
				</value>
		  	</uniform>
		  	
		  	<uniform>
				   <name>wingflex</name>
				   <type>int</type>
				   <value><use>wingflex</use></value>
			   </uniform>
			   
		   	   <uniform>
				   <name>wingflex_z</name>
				   <type>float</type>
				   <value><use>wingflex-z</use></value>
			   </uniform>

		   	   <uniform>
				   <name>body_width</name>
				   <type>float</type>
				   <value><use>body-width</use></value>
			   </uniform>

		   	   <uniform>
				   <name>wing_span</name>
				   <type>float</type>
				   <value><use>wing-span</use></value>
			   </uniform>

		   	   <uniform>
				   <name>rotation_rad</name>
				   <type>float</type>
				   <value><use>rotation-rad</use></value>
			   </uniform>

		   	   <uniform>
				   <name>rotation_x1</name>
				   <type>float</type>
				   <value><use>rotation-x1</use></value>
			   </uniform>

		   	   <uniform>
				   <name>rotation_y1</name>
				   <type>float</type>
				   <value><use>rotation-y1</use></value>
			   </uniform>

		   	   <uniform>
				   <name>rotation_z1</name>
				   <type>float</type>
				   <value><use>rotation-z1</use></value>
			   </uniform>
			   
		   	   <uniform>
				   <name>rotation_x2</name>
				   <type>float</type>
				   <value><use>rotation-x2</use></value>
			   </uniform>

		   	   <uniform>
				   <name>rotation_y2</name>
				   <type>float</type>
				   <value><use>rotation-y2</use></value>
			   </uniform>

		   	   <uniform>
				   <name>rotation_z2</name>
				   <type>float</type>
				   <value><use>rotation-z2</use></value>
			   </uniform>
			   
		  <!-- 			END fog include -->
		  <!--<uniform>
			<name>rembrandt_enabled</name>
			<type>int</type>
			<value>
			  <use>rembrandt</use>
			</value>
		  </uniform>-->
		  </pass>
		</technique>
		
		<technique n="4">
		  <predicate>
			<and>
				<equal>
				  <value type="float">0.0</value>
				  <glversion/>
				</equal>
			</and>
		  </predicate>
		</technique>
		
		<technique n="5">
		  <predicate>
			<and>
				<equal>
				  <value type="float">0.0</value>
				  <glversion/>
				</equal>
			</and>
		  </predicate>
		</technique>
		
		<technique n="6">
		  <predicate>
			<and>
				<equal>
				  <value type="float">0.0</value>
				  <glversion/>
				</equal>
			</and>
		  </predicate>
		</technique>
		
		<technique n="7">
		  <predicate>
			<and>
				<equal>
				  <value type="float">0.0</value>
				  <glversion/>
				</equal>
			</and>
		  </predicate>
		</technique>
		
		<technique n="8">
		  <predicate>
			<and>
				<equal>
				  <value type="float">0.0</value>
				  <glversion/>
				</equal>
			</and>
		  </predicate>
		</technique>
		
		<technique n="9">
		  <predicate>
			<and>
				<equal>
				  <value type="float">0.0</value>
				  <glversion/>
				</equal>
			</and>
		  </predicate>
		</technique>
		
</PropertyList>