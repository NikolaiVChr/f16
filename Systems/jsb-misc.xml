<?xml version="1.0"?>


<system name="Miscelanous">

    <channel name="Misc" execrate="16">        
        
        <lag_filter name="/surface-positions/speedbrake-pos-anim-lag">
            <input> /surface-positions/speedbrake-pos-anim </input>
            <c1> 2 </c1>
        </lag_filter>

        <fcs_function name="systems/approach-speed">
            <description>Page A7-3 of Supplement HAF manual</description>
            <function>
                <table>
                    <independentVar lookup="row">inertia/weight-lbs</independentVar>
                    <tableData>
                      17000 125
                      20000 136
                      25000 152
                      30000 167
                      35000 180
                      40000 192
                      45000 204
                      48000 212
                    </tableData>
                </table>
            </function>
        </fcs_function>
        
        <fcs_function name="systems/buffeting/outputy">
            <function>
                <product>
                    <sum>
                        <sin>
                          <product>
                            <property>sim-time-sec</property>
                            <property>systems/buffeting/var1</property>
                          </product>
                        </sin>
                        <sin>
                          <product>
                            <property>sim-time-sec</property>
                            <property>systems/buffeting/var2</property>
                          </product>
                        </sin>
                        <sin>
                          <product>
                            <property>sim-time-sec</property>
                            <property>systems/buffeting/var3</property>
                          </product>
                        </sin>
                    </sum>
                    <!--<table>
                        <independentVar lookup="row">atmosphere/density-altitude</independentVar>
                        <tableData>
                              0.0         1.0
                          30000.0         0.0
                        </tableData>
                    </table>-->
                    <property>systems/buffeting/magnitude</property>
                </product>
            </function>
        </fcs_function>
        
        <fcs_function name="systems/buffeting/outputz">
            <function>
                <product>
                    <sum>
                        <sin>
                          <product>
                            <property>sim-time-sec</property>
                            <property>systems/buffeting/var1</property>
                            <v>776.345</v>
                          </product>
                        </sin>
                        <sin>
                          <product>
                            <property>sim-time-sec</property>
                            <property>systems/buffeting/var2</property>
                            <v>736.345</v>
                          </product>
                        </sin>
                        <sin>
                          <product>
                            <property>sim-time-sec</property>
                            <property>systems/buffeting/var3</property>
                            <v>756.345</v>
                          </product>
                        </sin>
                    </sum>
                    <!--<table>
                        <independentVar lookup="row">atmosphere/density-altitude</independentVar>
                        <tableData>
                              0.0         1.0
                          30000.0         0.0
                        </tableData>
                    </table>-->
                    <property>systems/buffeting/magnitude</property>
                </product>
            </function>
        </fcs_function>
        
        <switch name="/f16/avionics/power-ufc-warming">
          <time>Could not find which elec source. But DED is powered from emerg ac 1 or 2, so it makes sense that it should work, hence using same source here.</time>
         <default value="0"/>
         <test  logic="AND" value="1">
           /f16/avionics/power-ufc == 1
           elec/bus/emergency-ac-1 gt 100
         </test>
         <test  logic="AND" value="1">
           /f16/avionics/power-ufc == 1
           elec/bus/emergency-ac-2 gt 100
         </test>
        </switch>
        
        <kinematic name="/f16/avionics/power-ufc-warm">
            <input>/f16/avionics/power-ufc-warming</input>
            <noscale/>
            <traverse>
                <setting>
                    <position>  0.0 </position>
                    <time>      0.0 </time>
                </setting>
                <setting>
                    <position>  1.0 </position>
                    <time>      5.0 </time>
                </setting>
            </traverse>
            <clipto>
                <min>   0 </min>
                <max>   1 </max>
            </clipto>
        </kinematic>

        <switch name="/f16/avionics/power-mfd-warming">
         <default value="0"/>
         <test  logic="AND" value="1">
           /f16/avionics/power-ufc-warm == 1
           /f16/avionics/power-mfd == 1
         </test>
        </switch>

        <actuator name="/f16/avionics/power-mfd-warm-act">
            <input>/f16/avionics/power-mfd-warming</input>
            <rate_limit sense="incr">0.25</rate_limit>
            <rate_limit sense="decr">10.0</rate_limit>
            <clipto>
                <min>   0 </min>
                <max>   1 </max>
            </clipto>
            <output>/f16/avionics/power-mfd-warm</output>
        </actuator>

        <switch name="/f16/avionics/power-mfd-monochrome">
            <default value="0"/>
            <test logic="OR" value="1">
                /sim/variant-id == 0    <!-- YF-16 -->
                /sim/variant-id == 1    <!-- Block 10 -->
                /sim/variant-id == 3    <!-- Block 30/32 -->
            </test>
        </switch>
        
        <switch name="/f16/avionics/power-mfd-bit">  <!-- 0=void, 1=grid, 2=cube, 3=on -->
         <default value="0"/>
         <!-- The color MFDs -->
         <test logic="AND" value="0">
           /f16/avionics/power-mfd-warm lt 0.2
           /f16/avionics/power-mfd-monochrome == 0
         </test>
         <test logic="AND" value="1">
           /f16/avionics/power-mfd-warm lt 0.6
           /f16/avionics/power-mfd-monochrome == 0
         </test>
         <test logic="AND" value="2">
           /f16/avionics/power-mfd-warm lt 1
           /f16/avionics/power-mfd-monochrome == 0
         </test>
         <test logic="AND" value="3">
           /f16/avionics/power-mfd-warm == 1
           /f16/avionics/power-mfd-monochrome == 0
         </test>
         <!-- The monochrome MFDs -->
         <test logic="AND" value="0">
           /f16/avionics/power-mfd-warm lt 1
           /f16/avionics/power-mfd-monochrome == 1
         </test>
         <test logic="AND" value="3">
           /f16/avionics/power-mfd-warm == 1
           /f16/avionics/power-mfd-monochrome == 1
         </test>
        </switch>

        <switch name="/f16/avionics/power-rdr-alt-warming">
         <default value="0"/>
         <test  logic="AND" value="1">
           /f16/avionics/power-rdr-alt gt 0
           elec/bus/ess-dc gt 20
         </test>
        </switch>

        <kinematic name="avionics/power-rdr-alt-warm">
            <input>/f16/avionics/power-rdr-alt-warming</input>
            <noscale/>
            <traverse>
                <setting>
                    <position>  0.0 </position>
                    <time>      0.0 </time>
                </setting>
                <setting>
                    <position>  1.0 </position>
                    <time>     60.0 </time>
                </setting>
            </traverse>
            <clipto>
                <min>   0 </min>
                <max>   1 </max>
            </clipto> 
            <output>/f16/avionics/power-rdr-alt-warm</output>
        </kinematic>
        
        <switch name="/f16/avionics/power-fcr-warming">
         <default value="0"/>
         <test  logic="AND" value="1">
           /f16/avionics/power-fcr == 1
           elec/bus/noness-dc gt 20
           elec/contactors/main-contactors-1 gt 100
         </test>
        </switch>
        
        <kinematic name="avionics/power-fcr-warm">
            <input>/f16/avionics/power-fcr-warming</input>
            <noscale/>
            <traverse>
                <setting>
                    <position>  0.0 </position>
                    <time>      0.0 </time>
                </setting>
                <setting>
                    <position>  1.0 </position>
                    <time>    120.0 </time><!-- if change this then change the countdown in MFD CRM also -->
                </setting>
            </traverse>
            <clipto>
                <min>   0 </min>
                <max>   1 </max>
            </clipto>
            <output>/f16/avionics/power-fcr-warm</output>
        </kinematic>
        
        <switch name="/f16/avionics/power-fcr-bit">
         <default value="0"/>
         <test logic="AND" value="0">
           /f16/avionics/power-fcr-warming == 0
         </test>
         <test logic="AND" value="2">
           /f16/avionics/power-fcr-warm == 1
         </test>
         <test logic="AND" value="1">
           /f16/avionics/power-fcr-warm gt 0
           /f16/avionics/power-fcr-warming == 1
         </test>
        </switch>
        
        <switch name="/f16/avionics/power-right-hdpt-warming">
         <default value="0"/>
         <test  logic="AND" value="1">
           /f16/avionics/power-right-hdpt == 1
           elec/bus/ess-dc gt 20
           /f16/stores/tgp-mounted gt 0
         </test>
        </switch>
        
        <kinematic name="avionics/power-right-hdpt-warm">
            <input>/f16/avionics/power-right-hdpt-warming</input>
            <noscale/>
            <traverse>
                <setting>
                    <position>  0.0 </position>
                    <time>      0.0 </time>
                </setting>
                <setting>
                    <position>  1.0 </position>
                    <time>    180.0 </time>
                </setting>
            </traverse>
            <clipto>
                <min>   0 </min>
                <max>   1 </max>
            </clipto>
            <output>/f16/avionics/power-right-hdpt-warm</output>
        </kinematic>
        
        <lag_filter name="/f16/fuel/hand-fwd-lag">
            <input> /f16/fuel/hand-fwd </input>
            <c1> 2 </c1>
        </lag_filter>
        
        <lag_filter name="/f16/fuel/hand-aft-lag">
            <input> /f16/fuel/hand-aft </input>
            <c1> 1 </c1>
        </lag_filter>
        
        <fcs_function name="propulsion/engine[0]/ftit-direct">
            <function>
                <sum>
                    <table><!-- engine fire will contribute some -->
                        <independentVar lookup="row">/engines/engine/n2</independentVar>
                        <independentVar lookup="column">/damage/fire/serviceable</independentVar>
                        <tableData>
                                           0     1
                               0          600    0
                              20          500    0
                              40          400    0
                              60          300    0
                              80          300    0 
                             100          300    0
                        </tableData>
                    </table>
                    <product><!-- egt to deg celcius -->
                        <difference>
                            <property>/engines/engine/egt-degf</property>
                            <v>32</v>
                        </difference>
                        <quotient>
                            <v>5</v>
                            <v>9</v>
                        </quotient>
                    </product>
                    <product><!-- add some extra from thrust -->
                        <value>250</value>
                        <min>
                            <value>1</value>
                            <quotient>
                                <property>/engines/engine/thrust_lb</property>
                                <property>/engines/engine/rated-mil-dry</property>
                            </quotient>
                        </min>
                    </product>
                    <table><!-- add some extra while cranking -->
                        <independentVar lookup="row">/engines/engine/n2</independentVar>
                        <independentVar lookup="column">/engines/engine/cranking</independentVar>
                        <tableData>
                                 0    1
                              0  0    0
                             20  0  400
                             50  0  400
                             60  0  200
                             70  0    0
                            100  0    0
                         </tableData>
                    </table>
                </sum>
            </function>
        </fcs_function>
        
        <lag_filter name="names/ftit-c">
            <input> propulsion/engine[0]/ftit-direct </input>
            <c1> 0.35 </c1>
            <output>/engines/engine[0]/ftit-degc</output>
        </lag_filter>

        <switch name="/f16/engine/ctl-sec">
            <default value="0"/>
            <test logic="OR" value="1">
                /engines/engine/n2 lt 18
                /f16/engine/sec-self-test eq 1
            </test>
        </switch>
        
        <fcs_function name="/f16/cockpit/pressure-ft-pressurized">
            <function>
                <table>
                    <independentVar>atmosphere/density-altitude</independentVar>
                    <tableData>
                            0        0
                         8000     8000
                        23000     8000
                        30000    13000
                        40000    17000
                        60000    22000
                    </tableData>
                </table>
            </function>
        </fcs_function>

        <switch name="/f16/cockpit/pressure-ft-selected">
            <default value="atmosphere/density-altitude"/>
            <test logic="AND" value="/f16/cockpit/pressure-ft-pressurized">
                fcs/canopy-engage eq 0
                fcs/canopy-pos-norm eq 0
                /canopy/not-serviceable eq 0
                /controls/ventilation/airconditioning-source eq 1
            </test>
        </switch>

        <switch name="/f16/cockpit/pressure-ft-c">
            <default value="0.35"/>
            <test logic="OR" value="5.0">
                fcs/canopy-engage eq 1
                fcs/canopy-pos-norm ne 0
                /canopy/not-serviceable eq 1
            </test>
        </switch>

        <lag_filter name="/f16/cockpit/pressure-ft">
            <input>/f16/cockpit/pressure-ft-selected</input>
            <c1>/f16/cockpit/pressure-ft-c</c1>
        </lag_filter>

        <actuator name="elec/switches/master-fuel-norm">
            <input>elec/switches/master-fuel-cmd</input>
            <rate_limit>0.25</rate_limit>
        </actuator>

        <switch name="elec/switches/master-fuel">
            <default value="1"/>
            <test value="0">
                elec/switches/master-fuel-norm lt 0.5
            </test>
        </switch>

    </channel>
    
    

    
    
    <channel name="oxygen 1" execrate="7200">
                
        <fcs_function name="systems/oxy-mins">
            <function>
                  <product>
                    <table>
                        <independentVar lookup="row">/f16/cockpit/pressure-ft</independentVar>
                        <tableData>
                              15000 29.86
                              20000 24.43
                              25000 21.72
                              30000 23.00
                              35000 30.94
                        </tableData>
                    </table>
                    <quotient>
                      <p>/f16/cockpit/oxygen-liters</p>
                      <v>5</v>
                    </quotient>
                    <v>60</v>
                  </product>
            </function>
            <output>/f16/cockpit/oxygen-minutes</output>
        </fcs_function>
        
        <fcs_function name="systems/oxy-lit">
            <function>
                <ifthen>
                  <gt>
                      <p>/f16/cockpit/oxygen-minutes</p>
                      <value>0</value>
                  </gt>
                  <product>
                    <p>/f16/cockpit/oxygen-liters</p>
                    <quotient>
                      <sum>
                        <p>/f16/cockpit/oxygen-minutes</p>
                        <v>-1</v><!-- channel execrate set to 1 minute -->
                      </sum>
                      <p>/f16/cockpit/oxygen-minutes</p>
                    </quotient>
                  </product>
                  <v>0</v>
                </ifthen>
            </function>
            <output>/f16/cockpit/oxygen-liters</output>
        </fcs_function>
    </channel>
    
    <channel name="oxygen 2" execrate="8">
                
        <switch name="/f16/avionics/oxy-psi-direct">
         <default value="0"/>
		 <test  logic="AND" value="150">
           /f16/cockpit/oxygen-liters gt 1
		    <test logic="OR">
			   <test logic="AND">
		           /f16/avionics/pbg-switch eq 1
			       /accelerations/pilot-g ge 4
			   </test>
		       /controls/test/test-panel/pbg-test == 1
		   </test>
           elec/bus/batt-2 gt 20
         </test>
		  <test  logic="AND" value="110">
           /f16/cockpit/oxygen-liters gt 0.5
		   <test logic="OR">
			   <test logic="AND">
		           /f16/avionics/pbg-switch eq 1
			       /accelerations/pilot-g ge 4
			   </test>
		       /controls/test/test-panel/pbg-test == 1
		   </test>
           elec/bus/batt-2 gt 20
         </test>
         <test  logic="AND" value="75">
           /f16/cockpit/oxygen-liters gt 1
		   <test logic="OR">
		       /f16/avionics/pbg-switch ne -1
		   </test>
           elec/bus/batt-2 gt 20
         </test>
         <test  logic="AND" value="55">
           /f16/cockpit/oxygen-liters gt 0.5
		   <test logic="OR">
		       /f16/avionics/pbg-switch ne -1
		   </test>
           elec/bus/batt-2 gt 20
         </test>
        </switch>
        
        <lag_filter name="/f16/avionics/oxy-psi">
            <input> /f16/avionics/oxy-psi-direct </input>
            <c1> 2.5 </c1>
        </lag_filter>
		
		<switch name="/f16/cockpit/oxygen-liters-switch">
			<default value="/f16/cockpit/oxygen-liters"/>
			<test value="0">
				/controls/test/test-panel/oxy-test eq 1
			</test>
		</switch>
		
		<actuator name="/f16/cockpit/oxygen-liters-output">
			<input>/f16/cockpit/oxygen-liters-switch</input>
			<rate_limit>1</rate_limit>
		</actuator>
                
    </channel>
    
    <channel name="hydrazine" execrate="720">
        
        <fcs_function name="systems/hydrazine-mins">
            <function>
              <max>
                <v>0</v>
                      <sum>
                        <p>/f16/cockpit/hydrazine-minutes</p>
                        <product>
                            <v>-0.1</v><!-- channel execrate set to 0.1 minute -->
                            <p>elec/sources/epu-require-hydrazine</p>
                        </product>
                      </sum>
              </max>
            </function>
            <output>/f16/cockpit/hydrazine-minutes</output>
        </fcs_function>
        
    </channel>
    
    <channel name="fuel-flow" execrate="8">
        <!--
          Simulates an oldstyle mechanical drum digit readout. It could use a max speed on digit rotation, but I dont want it to be too complex.
          -->
        <fcs_function name="flow/digit-1-value">
            <function>
              <product>
                <v>10</v>
                <difference>
                  <product>
                      <v>0.1</v>
                      <p>/engines/engine[0]/fuel-flow_pph</p>
                  </product>
                  <integer>
                      <product>
                          <v>0.1</v>
                          <p>/engines/engine[0]/fuel-flow_pph</p>
                      </product>
                  </integer>
                </difference>
              </product>
            </function>
        </fcs_function>
        
        <fcs_function name="flow/digit-1">
            <function>
                <sum>
                  <integer>
                    <p>flow/digit-1-value</p>
                  </integer>
                  <product>
                    <max>
                      <v>0</v>
                      <difference>
                        <fraction>
                            <p>flow/digit-1-value</p>
                        </fraction>
                        <v>0.9</v>
                      </difference>
                    </max>
                    <v>10</v>
                  </product>
                </sum>
            </function>
            <output>/f16/cockpit/fuel-flow-digit-1</output>
        </fcs_function>
        
        <fcs_function name="flow/digit-2-value">
            <function>
              <product>
                <v>10</v>
                <difference>
                  <product>
                      <v>0.01</v>
                      <p>/engines/engine[0]/fuel-flow_pph</p>
                  </product>
                  <integer>
                      <product>
                          <v>0.01</v>
                          <p>/engines/engine[0]/fuel-flow_pph</p>
                      </product>
                  </integer>
                </difference>
              </product>
            </function>
        </fcs_function>
        
        <fcs_function name="flow/digit-2">
            <function>
                <sum>
                  <integer>
                    <p>flow/digit-2-value</p>
                  </integer>
                  <product>
                    <max>
                      <v>0</v>
                      <difference>
                        <fraction>
                            <p>flow/digit-2-value</p>
                        </fraction>
                        <v>0.99</v>
                      </difference>
                    </max>
                    <v>100</v>
                  </product>
                </sum>
            </function>
            <output>/f16/cockpit/fuel-flow-digit-2</output>
        </fcs_function>
        
        <fcs_function name="flow/digit-3-value">
            <function>
              <product>
                <v>10</v>
                <difference>
                  <product>
                      <v>0.001</v>
                      <p>/engines/engine[0]/fuel-flow_pph</p>
                  </product>
                  <integer>
                      <product>
                          <v>0.001</v>
                          <p>/engines/engine[0]/fuel-flow_pph</p>
                      </product>
                  </integer>
                </difference>
              </product>
            </function>
        </fcs_function>
        
        <fcs_function name="flow/digit-3">
            <function>
                <sum>
                  <integer>
                    <p>flow/digit-3-value</p>
                  </integer>
                  <product>
                    <max>
                      <v>0</v>
                      <difference>
                        <fraction>
                            <p>flow/digit-3-value</p>
                        </fraction>
                        <v>0.999</v>
                      </difference>
                    </max>
                    <v>1000</v>
                  </product>
                </sum>
            </function>
            <output>/f16/cockpit/fuel-flow-digit-3</output>
        </fcs_function>
        
        <fcs_function name="flow/digit-4-value">
            <function>
              <product>
                <v>10</v>
                <difference>
                  <product>
                      <v>0.0001</v>
                      <p>/engines/engine[0]/fuel-flow_pph</p>
                  </product>
                  <integer>
                      <product>
                          <v>0.0001</v>
                          <p>/engines/engine[0]/fuel-flow_pph</p>
                      </product>
                  </integer>
                </difference>
              </product>
            </function>
        </fcs_function>
        
        <fcs_function name="flow/digit-4">
            <function>
                <sum>
                  <integer>
                    <p>flow/digit-4-value</p>
                  </integer>
                  <product>
                    <max>
                      <v>0</v>
                      <difference>
                        <fraction>
                            <p>flow/digit-4-value</p>
                        </fraction>
                        <v>0.9999</v>
                      </difference>
                    </max>
                    <v>10000</v>
                  </product>
                </sum>
            </function>
            <output>/f16/cockpit/fuel-flow-digit-4</output>
        </fcs_function>
        
        <fcs_function name="flow/digit-5-value">
            <function>
              <product>
                <v>10</v>
                <difference>
                  <product>
                      <v>0.00001</v>
                      <p>/engines/engine[0]/fuel-flow_pph</p>
                  </product>
                  <integer>
                      <product>
                          <v>0.00001</v>
                          <p>/engines/engine[0]/fuel-flow_pph</p>
                      </product>
                  </integer>
                </difference>
              </product>
            </function>
        </fcs_function>
        
        <fcs_function name="flow/digit-5">
            <function>
                <sum>
                  <integer>
                    <p>flow/digit-5-value</p>
                  </integer>
                  <product>
                    <max>
                      <v>0</v>
                      <difference>
                        <fraction>
                            <p>flow/digit-5-value</p>
                        </fraction>
                        <v>0.99999</v>
                      </difference>
                    </max>
                    <v>100000</v>
                  </product>
                </sum>
            </function>
            <output>/f16/cockpit/fuel-flow-digit-5</output>
        </fcs_function>
        
    </channel>

    <channel name="sound" execrate="8">
        
        <fcs_function name="/engines/engine[0]/sound-n2-low-down">
            <function>
                <table>
                    <independentVar lookup="row">/engines/engine/n2</independentVar>
                    <tableData>
                          60          1.0
                          95         -1.0
                    </tableData>
                </table>
            </function>
        </fcs_function>
        
        <fcs_function name="/engines/engine[0]/sound-n2-vol-a">
            <function>
                <sqrt>
                    <product>
                        <v>0.5</v>
                        <sum>
                            <v>1</v>
                            <p>/engines/engine[0]/sound-n2-low-down</p>
                        </sum>
                    </product>
                </sqrt>
            </function>
        </fcs_function>

        <fcs_function name="/engines/engine[0]/sound-n2-medium-up">
            <function>
                <table>
                    <independentVar lookup="row">/engines/engine/n2</independentVar>
                    <tableData>
                          60         -1.0
                          80          1.0
                    </tableData>
                </table>
            </function>
        </fcs_function>
        
        <fcs_function name="/engines/engine[0]/sound-n2-vol-b">
            <function>
                <sqrt>
                    <product>
                        <v>0.5</v>
                        <sum>
                            <v>1</v>
                            <p>/engines/engine[0]/sound-n2-medium-up</p>
                        </sum>
                    </product>
                </sqrt>
            </function>
        </fcs_function>

        <fcs_function name="/engines/engine[0]/sound-n2-medium-down">
            <function>
                <table>
                    <independentVar lookup="row">/engines/engine/n2</independentVar>
                    <tableData>
                          80          1.0
                          100        -1.0
                    </tableData>
                </table>
            </function>
        </fcs_function>
        
        <fcs_function name="/engines/engine[0]/sound-n2-vol-c">
            <function>
                <sqrt>
                    <product>
                        <v>0.5</v>
                        <sum>
                            <v>1</v>
                            <p>/engines/engine[0]/sound-n2-medium-down</p>
                        </sum>
                    </product>
                </sqrt>
            </function>
        </fcs_function>

        <fcs_function name="/engines/engine[0]/sound-n2-high-up">
            <function>
                <table>
                    <independentVar lookup="row">/engines/engine/n2</independentVar>
                    <tableData>
                          80         -1.0
                          100         1.0
                    </tableData>
                </table>
            </function>
        </fcs_function>
        
        <fcs_function name="/engines/engine[0]/sound-n2-vol-d">
            <function>
                <sqrt>
                    <product>
                        <v>0.5</v>
                        <sum>
                            <v>1</v>
                            <p>/engines/engine[0]/sound-n2-high-up</p>
                        </sum>
                    </product>
                </sqrt>
            </function>
        </fcs_function>
        
        <fcs_function name="/engines/engine[0]/n2-low"><!-- replaced with JFS sound -->
            <function>
                <table>
                    <independentVar lookup="row">/engines/engine/n2</independentVar>
                    <tableData>
                          0.1         0.0
                          1.0         0.1
                         25.0         1.0
                         35.0         0.75
                         45.0         0.0
                    </tableData>
                </table>
            </function>
        </fcs_function>
        
        <fcs_function name="/engines/engine[0]/n1-out1">
            <function>
                <table>
                    <independentVar lookup="row">/engines/engine/n1</independentVar>
                    <tableData>
                           0.5        0.0
                          15          1.0
                          30          1.0
                          40          0.0 
                    </tableData>
                </table>
            </function>
        </fcs_function>
        
        <fcs_function name="/engines/engine[0]/n1-out2">
            <function>
                <table>
                    <independentVar lookup="row">/engines/engine/n1</independentVar>
                    <tableData>
                           0.5        0.0
                           5          0.2
                          10          0.55
                          15          1.0
                          30          1.0
                         100          0.3 
                    </tableData>
                </table>
            </function>
        </fcs_function>
        
        <fcs_function name="/engines/engine[0]/n1-mid">
            <function>
                <table>
                    <independentVar lookup="row">/engines/engine/n1</independentVar>
                    <tableData>
                           5.5        0.0
                          10          0.75
                          15          1.0
                    </tableData>
                </table>
            </function>
        </fcs_function>
        
        <fcs_function name="/engines/engine[0]/n1-high">
            <function>
                <table>
                    <independentVar lookup="row">/engines/engine/n1</independentVar>
                    <tableData>
                          10          0.0
                          30          1.0
                    </tableData>
                </table>
            </function>
        </fcs_function>
        
        <fcs_function name="/engines/engine[0]/n2-60-to-80-log">
            <function>
                <log10>
                    <table>
                        <independentVar lookup="row">/engines/engine/n2</independentVar>
                        <tableData>
                              60          1.0
                              80          10.0
                        </tableData>
                    </table>
                </log10>
            </function>
        </fcs_function>

    </channel>

	<channel name="Aural tones" execrate="8">
		<switch name="/f16/avionics/gear-horn-cancel">
			<default value="0"/>
			<test logic="AND" value="1">
				/f16/avionics/gear-horn-cancel eq 1
				/velocities/speed-down-fps ge 4.17
				/velocities/airspeed-kt lt 190
				atmosphere/density-altitude lt 10000
				<test logic="OR">
					/gear/gear[0]/position-norm ne 1
					/gear/gear[1]/position-norm ne 1
					/gear/gear[2]/position-norm ne 1
				</test>
			</test>
			<test logic="AND" value="1">
				/controls/gear/gear-horn-cutout eq 1
			</test>
		</switch>

		<switch name="/f16/avionics/gear-horn">
			<description>Dash-1  1-70 and AD-A145-469</description>
			<default value="0"/>
			<test logic="AND" value="0">
				/f16/avionics/gear-horn-cancel eq 1
			</test>
			<test logic="AND" value="1">
				/velocities/speed-down-fps ge 4.17
				/velocities/airspeed-kt lt 190
				atmosphere/density-altitude lt 10000
				<test logic="OR">
					/gear/gear[0]/position-norm ne 1
					/gear/gear[1]/position-norm ne 1
					/gear/gear[2]/position-norm ne 1
				</test>
			</test>
		</switch>

        <fcs_function name="/f16/avionics/low-speed-warning-tone-schedule-hystLow">
            <description>Dash 1  1-95
                        Low hysteresis
                         KIAS=7/3pitchDeg-30
                         LIAS=-7/3pitchDeg+390
                        High hysteresis
                         KIAS=2pitchDeg+40
                         KIAS=-2pitchDeg+400

                        where pitchDeg goes from 0 to 180, 0 being level, 180 being level inverted level
            </description>
            <function>
                <ifthen>
                    <lt>
                        <abs>
                            <property>/orientation/roll-deg</property>
                        </abs>
                        <value>90</value>
                    </lt>
                    <sum>
                        <product>
                            <v>2.333333</v>
                            <property>/orientation/pitch-deg</property>
                        </product>
                        <v>-30</v>
                    </sum>
                    <sum>
                        <product>
                            <v>-2.333333</v>
                            <sum>
                                <product>
                                    <property>/orientation/pitch-deg</property>
                                    <v>-1</v>
                                </product>
                                <v>180</v>
                            </sum>
                        </product>
                        <v>390</v>
                    </sum>
                </ifthen>
            </function>
        </fcs_function>
        <fcs_function name="/f16/avionics/low-speed-warning-tone-schedule-hystHigh">
            <description>Dash 1  1-95
                        Low hysteresis
                         KIAS=7/3pitchDeg-30
                         LIAS=-7/3pitchDeg+390
                        High hysteresis
                         KIAS=2pitchDeg+40
                         KIAS=-2pitchDeg+400

                         
            </description>
            <function>
                <ifthen>
                    <lt>
                        <abs>
                            <property>/orientation/roll-deg</property>
                        </abs>
                        <value>90</value>
                    </lt>
                    <sum>
                        <product>
                            <v>2</v>
                            <property>/orientation/pitch-deg</property>
                        </product>
                        <v>40</v>
                    </sum>
                    <sum>
                        <product>
                            <v>-2</v>
                            <sum>
                                <product>
                                    <property>/orientation/pitch-deg</property>
                                    <v>-1</v>
                                </product>
                                <v>180</v>
                            </sum>
                        </product>
                        <v>400</v>
                    </sum>
                </ifthen>
            </function>
        </fcs_function>

        <switch name="/f16/avionics/low-speed-warning-tone-a">
            <description>Dash-1  1-96 and AD-A145-469</description>
            <default value="0"/>
            <test  logic="AND" value="1">
                /orientation/pitch-deg gt 45
                /velocities/airspeed-kt lt /f16/avionics/low-speed-warning-tone-schedule-hystLow
                /controls/flight/flaps == 0
                /controls/gear/gear-down ne 1
            </test>
            <test  logic="AND" value="1">
                /orientation/pitch-deg gt 45
                /f16/avionics/low-speed-warning-tone-a == 1
                /velocities/airspeed-kt lt /f16/avionics/low-speed-warning-tone-schedule-hystHigh
                /controls/flight/flaps == 0
                /controls/gear/gear-down ne 1
            </test>
        </switch>

        <switch name="/f16/avionics/low-speed-to-config">
            <description>AD-A145-469</description>
            <default value="0"/>
            <test  logic="OR" value="1">
                fcs/fly-by-wire/tef/tef-pos-norm ne 0
                /controls/gear/gear-down ne 0
            </test>
        </switch>

        <switch name="/f16/avionics/low-speed-warning-tone-b">
            <description>AD-A145-469</description>
            <default value="0"/>
            <test  logic="AND" value="1">
                /orientation/alpha-deg gt 15
                /f16/avionics/low-speed-to-config == 1
            </test>
        </switch>

	</channel>

    <channel name="MSL floor" execrate="120">
        <fcs_function name="/f16/avionics/msl-floor-reached">
            <function>
                <ifthen>
                    <lt>
                        <abs>
                            <difference>
                                <property>/f16/settings/msl-floor</property>
                                <property>/instrumentation/altimeter/indicated-altitude-ft</property>
                            </difference>
                        </abs>
                        <abs><property>/velocities/vertical-speed-fps</property></abs>
                    </lt>
                    <v>1</v>
                    <v>0</v>
                </ifthen>
            </function>
        </fcs_function>
    </channel>

	<channel name="VVI">
		
		<fcs_function name="/f16/avionics/vvi-indicated-speed-fps">
			<function>
				<ifthen>
					<and>
						<property>/systems/static/serviceable</property>
						<gt>
							<property>elec/bus/emergency-ac-1</property>
							<value>100</value>
						</gt>
					</and>
					<property>/velocities/vertical-speed-fps</property>
					<v>-6000</v>
				</ifthen>
			</function>
		</fcs_function>
		
	</channel>
  
  <channel name="Readouts">
    
    <switch name="/engines/engine[0]/nozzle-pos-norm-switch">
     <default value="/engines/engine[0]/nozzle-pos-norm-switch"/>
     <test  logic="AND" value="/engines/engine[0]/nozzle-pos-norm">
        elec/bus/emergency-ac-2 gt 100
     </test>
    </switch>
    
    <lag_filter name="/engines/engine[0]/nozzle-pos-norm-lag">
        <input> /engines/engine[0]/nozzle-pos-norm-switch </input>
        <c1> 10 </c1>
    </lag_filter>
    
  </channel>

  <channel name="Cursors" execrate="8">

      <!-- Integrates cursor control, and allow the integrator to be reset from outside.
          Displays can know how much the cursor moved between two updates by
          reading this property then reseting it to 0. ~Colin (JA37)
      -->

      <fcs_function name="names/cursor/cursor-slew-x-delta-acc">
        <function>
          <sum>
            <property>/controls/displays/cursor-slew-x-delta-acc</property>
            <product>
              <abs>
                <property>/controls/displays/cursor-slew-x</property>
              </abs>
              <property>simulation/channel-dt</property>
              <v>2</v>
            </product>
          </sum>
        </function>
        <output>/controls/displays/cursor-slew-x-delta-acc</output>
        <clipto>
            <min>   0 </min>
            <max>   1 </max>
        </clipto>
      </fcs_function>

      <switch name="names/cursor/cursor-slew-x-delta-acc-reset">
         <default value="/controls/displays/cursor-slew-x-delta-acc"/>
         <test  logic="AND" value="0">
            /controls/displays/cursor-slew-x == 0
         </test>
         <output>/controls/displays/cursor-slew-x-delta-acc</output>
      </switch>

      <fcs_function name="names/cursor/cursor-slew-y-delta-acc">
        <function>
          <sum>
            <property>/controls/displays/cursor-slew-y-delta-acc</property>
            <product>
              <abs>
                <property>/controls/displays/cursor-slew-y</property>
              </abs>
              <property>simulation/channel-dt</property>
              <v>2</v>
            </product>
          </sum>
        </function>
        <output>/controls/displays/cursor-slew-y-delta-acc</output>
        <clipto>
            <min>   0 </min>
            <max>   1 </max>
        </clipto>
      </fcs_function>

      <switch name="names/cursor/cursor-slew-y-delta-acc-reset">
         <default value="/controls/displays/cursor-slew-y-delta-acc"/>
         <test  logic="AND" value="0">
            /controls/displays/cursor-slew-y == 0
         </test>
         <output>/controls/displays/cursor-slew-y-delta-acc</output>
      </switch>

      <fcs_function name="names/cursor/cursor-slew-x-delta">
        <function>
          <sum>
            <property>/controls/displays/cursor-slew-x-delta</property>
            <product>
              <property>/controls/displays/cursor-slew-x-delta-acc</property>
              <property>/controls/displays/cursor-slew-x</property>
              <property>simulation/channel-dt</property>
            </product>
          </sum>
        </function>
        <output>/controls/displays/cursor-slew-x-delta</output>
      </fcs_function>

      <fcs_function name="names/cursor/cursor-slew-y-delta">
        <function>
          <sum>
            <property>/controls/displays/cursor-slew-y-delta</property>
            <product>
              <property>/controls/displays/cursor-slew-y-delta-acc</property>
              <property>/controls/displays/cursor-slew-y</property>
              <property>simulation/channel-dt</property>
            </product>
          </sum>
        </function>
        <output>/controls/displays/cursor-slew-y-delta</output>
      </fcs_function>

  </channel>

  <channel name="AOA_limits" execrate="8">
      <switch name="/f16/fcs/autopilot-aoa-limit-exceed">
            <description>GR1F-16CJ-1 page 1-135</description>
            <default value="0"/>
            <test value="1">
                /orientation/alpha-deg gt 15
            </test>
        </switch>
  </channel>

</system>
